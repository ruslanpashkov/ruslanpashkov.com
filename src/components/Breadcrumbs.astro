---
import type { Crumb } from '@/types/Crumb';

import { Icon } from 'astro-icon/components';

interface Props {
	breadcrumbs: Crumb[];
}

const { breadcrumbs } = Astro.props;
---

<nav aria-label="Breadcrumbs" class="breadcrumbs">
	<ol class="breadcrumbs__list">
		{
			breadcrumbs.map((crumb, index) => (
				<li class="breadcrumbs__item">
					{crumb.current ? (
						<span aria-current="page" class="breadcrumbs__text">
							{crumb.label}
						</span>
					) : (
						<a class="breadcrumbs__text breadcrumbs__link hover" href={crumb.url}>
							{crumb.label}
						</a>
					)}

					{index < breadcrumbs.length - 1 && (
						<Icon
							aria-hidden="true"
							class="breadcrumbs__separator"
							name="chevron-down"
						/>
					)}
				</li>
			))
		}
	</ol>
</nav>

<style>
	.breadcrumbs {
		--crumbs-spacing: 12px;

		position: relative;
		overflow: hidden;
	}

	.breadcrumbs__list {
		scrollbar-width: none;
		scroll-snap-type: x mandatory;
		overflow-x: auto;
		display: flex;
		gap: var(--crumbs-spacing);
		align-items: center;
	}

	.breadcrumbs__item {
		scroll-snap-align: start;
		display: flex;
		column-gap: var(--crumbs-spacing);
		align-items: center;
		white-space: nowrap;
	}

	.breadcrumbs__item[aria-current='page'] {
		color: var(--color-contrast);
	}

	.breadcrumbs__text {
		padding-block: 0.5em;
		font-size: 1.125rem;
	}

	.breadcrumbs__link:focus-visible {
		--offset-width: -2px;

		border-radius: 6px;
		outline: 2px solid var(--color-focus);
		outline-offset: var(--offset-width);
	}

	.breadcrumbs__separator {
		transform: rotate(-90deg);
		max-width: max-content;
		color: var(--color-neutral);
	}

	.breadcrumbs__mask {
		pointer-events: none;
		position: absolute;
		top: 0;
		width: 48px;
		height: 100%;
		background-color: var(--color-primary);
		transition: opacity var(--motion-duration) ease;
	}

	.breadcrumbs__mask--start {
		right: auto;
		left: 0;
		opacity: 0;
		mask-image: linear-gradient(to left, transparent, black 90%);
	}

	.breadcrumbs__mask--end {
		right: 0;
		left: auto;
		mask-image: linear-gradient(to right, transparent, black 90%);
	}
</style>

<script src="../scripts/crumbs.ts"></script>
